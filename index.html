<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="google-site-verification" content="xrZFu5cpuycZgitIQWcRT0DmD7er9zSVNmzWktTYs10" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https: data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline';">
    
    <title>ChromePortal | Full Click</title> 
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ€</text></svg>">
    
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-bg: rgba(255, 255, 255, 0.9);
            --text-main: #2d3436;
            --accent: #0984e3;
            --danger: #d63031;
            --shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container { 
            width: 100%; 
            max-width: 900px; 
            padding: 20px;
            flex: 1;
        }

        header { text-align: center; margin-bottom: 30px; }
        h1 { font-size: 2.5rem; color: var(--accent); margin: 0; }

        .search-container { margin-bottom: 25px; }
        #searchBar {
            width: 100%; padding: 15px 20px; border-radius: 50px;
            border: 1px solid rgba(0,0,0,0.1); outline: none; box-shadow: var(--shadow);
            box-sizing: border-box;
        }

        .input-panel {
            background: var(--card-bg); padding: 20px; border-radius: 16px;
            display: grid; grid-template-columns: 1fr 1fr auto; gap: 12px; margin-bottom: 40px;
            box-shadow: var(--shadow);
        }

        .api-panel {
            background: #2d3436; color: white; padding: 10px 20px; border-radius: 10px;
            margin-bottom: 20px; display: flex; gap: 10px; align-items: center;
        }

        input { padding: 12px; border-radius: 8px; border: 1px solid #ddd; outline: none; }
        .api-panel input { flex: 1; background: #3d4446; border: none; color: white; }

        .add-btn {
            background: var(--accent); color: white; border: none; padding: 12px 25px;
            border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .add-btn:hover { transform: scale(1.03); background: #0773c5; }

        .link-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 20px; }
        
        .link-card {
            background: white; border-radius: 12px; padding: 15px;
            display: flex; flex-direction: column; align-items: center;
            position: relative; transition: 0.3s; animation: pop 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            cursor: pointer;
        }
        @keyframes pop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .link-card:hover { transform: translateY(-5px); box-shadow: var(--shadow); background: #fdfdfd; }
        .link-card img { width: 32px; height: 32px; margin-bottom: 10px; border-radius: 4px; pointer-events: none; }
        .link-card a { color: var(--text-main); text-decoration: none; font-weight: 600; font-size: 0.9rem; text-align: center; pointer-events: none; }

        .delete-btn {
            position: absolute; top: 5px; right: 5px; background: var(--danger);
            color: white; border: none; width: 22px; height: 22px; border-radius: 50%;
            cursor: pointer; display: none; font-size: 12px; z-index: 10;
        }
        .link-card:hover .delete-btn { display: block; }

        .site-footer {
            flex-shrink: 0; padding: 25px; text-align: center;
            color: #636e72; font-size: 0.9rem; width: 100%;
            font-weight: 500; border-top: 1px solid rgba(0,0,0,0.05);
            background: rgba(255,255,255,0.2);
        }

        @media (max-width: 600px) { 
            .input-panel { grid-template-columns: 1fr; } 
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ChromePortal</h1>
        <p>Private Shortcut Dashboard</p>
    </header>

    <div class="api-panel">
        <span>ðŸ”‘ API Key:</span>
        <input type="password" id="apiKey" placeholder="Stored in local browser only...">
        <button class="add-btn" style="padding: 5px 15px;" onclick="saveApiKey()">Save</button>
    </div>

    <div class="search-container">
        <input type="text" id="searchBar" placeholder="Search saved links..." oninput="filterLinks()">
    </div>

    <div class="input-panel">
        <input type="text" id="siteName" placeholder="Name (e.g. YouTube)">
        <input type="text" id="siteUrl" placeholder="URL (e.g. youtube.com)">
        <button class="add-btn" onclick="addLink()">Create Shortcut</button>
    </div>

    <div id="linkGrid" class="link-grid"></div>
</div>

<footer class="site-footer">
    Created on 21 Feb 2026
</footer> 

<script>
    let allLinks = JSON.parse(localStorage.getItem('chromePortalLinks')) || [];
    let config = {};

    // 1. LOAD CONFIG AND START APP
    async function initApp() {
        try {
            // Fetching your secret json file
            const response = await fetch('config.json');
            if (!response.ok) throw new Error("Config file not found");
            config = await response.json();
            
            // Sync the API key UI if it exists in your HTML
            const apiInput = document.getElementById('apiKey');
            if (apiInput) apiInput.value = config.api_key || localStorage.getItem('user_google_api_key') || '';
            
            console.log("Portal Ready: Config Loaded");
        } catch (err) {
            console.warn("Running without config.json (Local file access might be restricted)");
        }
        displayLinks();
    }

    window.onload = initApp;

    // 2. SAVE API KEY (Saves to LocalStorage as a backup)
    function saveApiKey() {
        const key = document.getElementById('apiKey').value;
        localStorage.setItem('user_google_api_key', key);
        alert("API Key saved to browser memory!");
    }

    // 3. ADD NEW LINK
    function addLink() {
        const nameInput = document.getElementById('siteName');
        const urlInput = document.getElementById('siteUrl');
        const name = nameInput.value.trim();
        let url = urlInput.value.trim();

        if (!name || !url) { 
            alert("Please fill in both name and URL!"); 
            return; 
        }

        // Auto-fix URL format
        if (!url.startsWith('http')) url = 'https://' + url;

        const newLink = { name, url, id: Date.now() };
        allLinks.push(newLink);
        saveAndRefresh();

        nameInput.value = '';
        urlInput.value = '';
    }

    function saveAndRefresh() {
        localStorage.setItem('chromePortalLinks', JSON.stringify(allLinks));
        displayLinks();
    }

    // 4. RENDER LINKS TO GRID (SECURE METHOD)
    function displayLinks(data = allLinks) {
        const grid = document.getElementById('linkGrid');
        grid.innerHTML = ''; 

        data.forEach(link => {
            // Create elements manually to prevent XSS (Injection attacks)
            const card = document.createElement('div');
            card.className = 'link-card';
            
            // Delete Button
            const delBtn = document.createElement('button');
            delBtn.className = 'delete-btn';
            delBtn.textContent = 'âœ•';
            delBtn.onclick = (e) => { 
                e.stopPropagation(); 
                deleteLink(link.id); 
            };

            // Icon Image
            const img = document.createElement('img');
            // We use the favicon service (you can append ?key=${config.api_key} if your API needs it)
            img.src = `https://www.google.com/s2/favicons?sz=64&domain=${link.url}`;
            
            // If Google fails, use your 'logo.png' file!
            img.onerror = () => {
                img.src = 'logo.png'; 
            };

            // Link Text
            const a = document.createElement('a');
            a.textContent = link.name;
            a.href = link.url;

            // Open link securely in new tab
            card.onclick = () => window.open(link.url, '_blank', 'noopener,noreferrer');

            // Assemble Card
            card.appendChild(delBtn);
            card.appendChild(img);
            card.appendChild(a);
            grid.appendChild(card);
        });
    }

    // 5. DELETE & FILTER
    function deleteLink(id) {
        if(confirm("Delete this shortcut?")) {
            allLinks = allLinks.filter(l => l.id !== id);
            saveAndRefresh();
        }
    }

    function filterLinks() {
        const term = document.getElementById('searchBar').value.toLowerCase();
        const filtered = allLinks.filter(l => l.name.toLowerCase().includes(term));
        displayLinks(filtered);
    }

    // Shortcut: Press Enter to add link
    document.addEventListener('keypress', (e) => { 
        if (e.key === 'Enter' && document.activeElement.tagName !== 'TEXTAREA') {
            addLink(); 
        }
    });
</script>

</body>
</html>
